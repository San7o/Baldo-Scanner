#pragma once

#include <string>
#include <sqlite3.h>
#include "common/settings.hpp"

namespace AV
{

/*
 * This class is responsible for handling a SQLite
 * database containing malware signatures.
 */
class MalwareDB
{
public:

/* 
 * The connection instance, each scan will
 * have It's own MalwareDB and it's own connection.
 */
sqlite3* connection;

/* Constructors */
MalwareDB() {}
MalwareDB(std::string filename);
/* Destructor */
~MalwareDB();

/* Methods */

int fetch();
int load(std::string path);
int update();

private:
void check_sqlite_error(int rc, sqlite3* db);
};

}
